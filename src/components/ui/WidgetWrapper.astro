---
import type { HTMLTag } from 'astro/types';
import type { Widget } from '~/types';
import { twMerge } from 'tailwind-merge';
import Background from './Background.astro';

export interface Props extends Widget {
  containerClass?: string;
  sectionBgClass?: string; // ✅ NEW
  ['as']?: HTMLTag;
}

const {
  id,
  isDark = false,
  containerClass = '',
  sectionBgClass = '',
  bg,
  as = 'section',
} = Astro.props;

const WrapperTag = as;
---

<WrapperTag class="relative w-full">
  <!-- ✅ FULL WIDTH BACKGROUND (ONLY IF PROP EXISTS) -->
  {sectionBgClass && (
    <div
      class={`absolute inset-0 -z-[1] ${sectionBgClass}`}
      aria-hidden="true"
    />
  )}

  <!-- existing background logic (unchanged) -->
  <div class="absolute inset-0 pointer-events-none -z-[2]" aria-hidden="true">
    <slot name="bg">
      {bg ? <Fragment set:html={bg} /> : <Background isDark={isDark} />}
    </slot>
  </div>

  <!-- CONTENT -->
  <div
    class:list={[
      twMerge(
        'relative mx-auto max-w-7xl px-4 md:px-6 py-4 md:py-12 lg:py-4 text-default',
        containerClass
      ),
      { dark: isDark },
    ]}
  >
    <slot />
  </div>
</WrapperTag>
