---
import ConactSection from '~/components/HomePage/ConactSection.astro';
import Hero from '~/components/widgets/Hero.astro';
import ServicesAll from '~/components/widgets/ServicesAll.astro';
import Layout from '~/layouts/PageLayout.astro';
import { BASE_URL } from '~/utils/apliInstance';

/* =====================
   SEO Metadata
===================== */
let metadata: {
  title?: string;
  description?: string;
} = {};

/* =====================
   Fallback Data
===================== */
const fallbackData = {
  heading: 'Our Services88',
  sub_heading:
    'Expert stairlift services to support safe and comfortable movement at home.',
  hero_bg_image:
    'https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1740&q=80',
};

/* =====================
   Page Data
===================== */
let pageData = fallbackData;
 let AllserviceData = [];
try {
  const res = await fetch(`${BASE_URL}/items/Service_Page?fields=*,seo.*`);
  const resAllservice = await fetch(`${BASE_URL}/items/Services`);

   

  if (res.ok) {
    const apiData = await res.json();
    const apiDataService= await resAllservice.json();
 
    AllserviceData = apiDataService?.data ?? [];
    pageData = apiData?.data?.[0] ?? fallbackData; 
    metadata = {
      title: pageData?.seo?.meta_title ,
      description:
        pageData?.seo?.meta_description ,
        ogImage: pageData?.seo?.og_image ?`${BASE_URL}/assets/${pageData?.seo?.og_image}`:undefined,
 
    };
 
  }
} catch (error) {
  console.warn('Directus API failed, using fallback data');
}

---

<Layout metadata={metadata} headerText="">
  <!-- =====================
       Hero Section
  ====================== -->
  <Hero
 heroData={pageData}
   
  />

  <!-- =====================
       What We Offer
  ====================== -->
  <section class="max-w-7xl mx-auto px-4 py-12">
    <h2 class="text-4xl font-bold text-secondary mb-7">
      What We Offer
    </h2>
    <ServicesAll data={AllserviceData} />
  </section>

  <!-- =====================
       Contact Section
  ====================== -->
  <ConactSection />
</Layout>
